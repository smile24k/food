import{a as e,r as a}from"./index.63039e53.js";import{D as o,x as l,y as s,z as r,Q as t,J as n,K as m,A as i,b as d,d as u,E as g,H as f,G as p,o as c}from"./vendor.0f5a02ad.js";const b={name:"Login",setup(){const{proxy:n}=o();l();const m=s(null),d=s("top");let u=s();r((()=>{localStorage.removeItem("token"),localStorage.removeItem("loginRes")}));const g=t({username:"",password:""}),f=async()=>{if(u.value)return;u.value=!0;const[o,l={}]=await i(e.login(g));return u.value=!1,o?void 0:200!==l.status?a.call(n,l):void(l.data&&(localStorage.setItem("token",l.data.token),localStorage.setItem("loginRes",JSON.stringify(l.data)),n.$message.success("登录成功"),setTimeout((()=>{location.href="/"}),1500)))};return{labelPosition:d,formData:g,rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:5,max:50,message:"用户名长度在 5 到 20 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},loginForm:m,loading:u,submitForm:()=>{m.value.validate((e=>{if(!e)return n.$message.error("请输入账号/密码错误");f()}))}}}},v=g("data-v-7a3f1bf0");n("data-v-7a3f1bf0");const x={class:"login"},w={class:"login-form-box"},y=f("登 录");m();const D=v(((e,a,o,l,s,r)=>{const t=p("el-input"),n=p("el-form-item"),m=p("el-button"),i=p("el-form");return c(),d("div",x,[u("div",w,[u(i,{ref:"loginForm","label-position":l.labelPosition,"label-width":"80px",model:l.formData,rules:l.rules},{default:v((()=>[u(n,{label:"用户名",prop:"username"},{default:v((()=>[u(t,{modelValue:l.formData.username,"onUpdate:modelValue":a[1]||(a[1]=e=>l.formData.username=e),placeholder:"手机号/账号",maxlength:"20"},null,8,["modelValue"])])),_:1}),u(n,{label:"密码",prop:"password"},{default:v((()=>[u(t,{modelValue:l.formData.password,"onUpdate:modelValue":a[2]||(a[2]=e=>l.formData.password=e),placeholder:"密码",maxlength:"12",type:"password"},null,8,["modelValue"])])),_:1}),u(n,null,{default:v((()=>[u(m,{type:"primary",size:"medium",round:"",onClick:l.submitForm,loading:l.loading},{default:v((()=>[y])),_:1},8,["onClick","loading"])])),_:1})])),_:1},8,["label-position","model","rules"])])])}));b.render=D,b.__scopeId="data-v-7a3f1bf0";export{b as default};
